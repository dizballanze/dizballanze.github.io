<!DOCTYPE html>
<html lang="en">
<head>
        <title>MySQL - обзор типов таблиц</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="/theme/css/app.css" type="text/css" />
        <link href="http://dizballanze.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Tech blog by @dizballanze Atom Feed" />
        <link href="http://dizballanze.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Tech blog by @dizballanze RSS Feed" />
        <link href="/static/icons/favicon.ico" rel="icon" type="image/x-icon" />
        <link href="/static/icons/favicon.ico" rel="shortcut icon" type="image/x-icon" />
        
        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="/css/ie.css"/>
                <script src="/js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="/css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">

<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/ru_RU/all.js#xfbml=1&appId=143995599087385";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<a href="https://github.com/dizballanze">
<img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" />
</a>
        <header id="banner" class="body">
                <h1><a href="/">Tech blog by @dizballanze </a></h1>
                <nav><ul>
                    <li><a href="/автор/">Автор</a></li>
                    <li class="active"><a href="/category/bd.html">БД</a></li>
                    <li ><a href="/category/drugoe.html">Другое</a></li>
                    <li ><a href="/category/linux.html">Linux</a></li>
                    <li ><a href="/category/nodejs.html">Node.js</a></li>
                    <li ><a href="/category/python.html">Python</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/bd/mysql-obzor-tipov-tablits/" rel="bookmark"
           title="Permalink to MySQL - обзор типов таблиц">MySQL - обзор типов таблиц</a></h1>
<a href="http://twitter.com/share" class="twitter-share-button" data-width="80" data-count="horizontal" data-via="dizballanze" style="display:inline-block;">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

<div class="fb-like" data-send="false" data-layout="button_count" data-width="110" data-show-faces="true" data-font="trebuchet ms" style="display:inline-block;"></div>

<g:plusone size="medium" width="110" height="22" annotation="inline"></g:plusone>

<script type="text/javascript">
window.___gcfg = {
lang: 'en-US'
  };

  (function() {
var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
po.src = 'https://apis.google.com/js/plusone.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
})();
</script>

<!-- Put this script tag to the <head> of your page -->
<script type="text/javascript" src="//vk.com/js/api/openapi.js?75"></script>

<script type="text/javascript">
  VK.init({apiId: 2478358, onlyWidgets: true});
</script>

<!-- Put this div tag to the place, where the Like block will be -->
<div id="vk_like" style="display: inline-block; width: 110px;"></div>
<script type="text/javascript">
VK.Widgets.Like("vk_like", {type: "button"});
</script>    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2011-01-29T18:42:00+03:00">
                сб 29 января 2011
        </abbr>
<p>категория: <a href="/category/bd.html">БД</a>. </p>
<p>теги: <a href="/tag/benchmark/">benchmark</a><a href="/tag/innodb/">innodb</a><a href="/tag/myisam/">myisam</a><a href="/tag/mysql/">MySQL</a><a href="/tag/bd/">БД</a></p>
</footer><!-- /.post-info -->      <p><img alt="mysql" src="/media/2011/01/mysql-125x125.png" title="MySQL logo" /></p>
<p>Здравствуйте, сегодня мы поговорим о типах таблиц в MySQL. Архитектура
MySQL позволяет подключать разные движки таблиц. На данный момент MySQL
поддерживает множество различных типов таблиц, каждый из которых имеет
свои преимущества и недостатки. Я перечислю и коротко опишу основные
типы таблиц, а затем проведу небольшой тест производительности наиболее
часто используемых типов - myisam и innodb.</p>
<p>Для того что-бы посмотреть какие типы поддерживает ваша инсталляция
MySQL необходимо выполнить следующий SQL запрос:</p>
<pre><code>:::sql
SHOW ENGINES;
</code></pre>
<p>В результате вы получаете таблицу содержащую информацию о том какие типы
таблиц установлены в вашей системе и краткое описание их возможностей.</p>
<table>
<thead>
<tr>
<th align="left">Engine</th>
<th align="left">Support</th>
<th align="left">Comment</th>
<th align="left">Transactions</th>
<th align="left">XA</th>
<th align="left">Savepoints</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">FEDERATED</td>
<td align="left">NO</td>
<td align="left">Federated MySQL storage engine</td>
<td align="left">NULL</td>
<td align="left">NULL</td>
<td align="left">NULL CSV</td>
</tr>
<tr>
<td align="left">MyISAM</td>
<td align="left">YES</td>
<td align="left">MyISAM storage engine</td>
<td align="left">NO</td>
<td align="left">NO</td>
<td align="left">NO</td>
</tr>
<tr>
<td align="left">BLACKHOLE</td>
<td align="left">YES</td>
<td align="left">/dev/null storage engine (anything you write to it disappears)</td>
<td align="left">NO</td>
<td align="left">NO</td>
<td align="left">NO</td>
</tr>
<tr>
<td align="left">MRG_MYISAM</td>
<td align="left">YES</td>
<td align="left">Collection of identical MyISAM tables</td>
<td align="left">NO</td>
<td align="left">NO</td>
<td align="left">NO</td>
</tr>
<tr>
<td align="left">MEMORY</td>
<td align="left">YES</td>
<td align="left">Hash based, stored in memory, useful for temporary tables</td>
<td align="left">NO</td>
<td align="left">NO</td>
<td align="left">NO</td>
</tr>
<tr>
<td align="left">ARCHIVE</td>
<td align="left">YES</td>
<td align="left">Archive storage engine</td>
<td align="left">NO</td>
<td align="left">NO</td>
<td align="left">NO</td>
</tr>
<tr>
<td align="left">InnoDB</td>
<td align="left">DEFAULT</td>
<td align="left">Supports transactions, row-level locking, and foreign keys</td>
<td align="left">YES</td>
<td align="left">YES</td>
<td align="left">YES</td>
</tr>
<tr>
<td align="left">PERFORMANCE_SCHEMA</td>
<td align="left">YES</td>
<td align="left">Performance Schema</td>
<td align="left">NO</td>
<td align="left">NO</td>
<td align="left">NO</td>
</tr>
</tbody>
</table>
<p>Нас в основном будет интересовать столбец support, который содержит
информацию о поддержке типа таблицы и может принимать значения: NO - не
поддерживается, YES - поддерживается, DEFAULT -используется
по-умолчанию. Начиная с версии 5.5.5 по-умолчанию выбран тип innodb,
ранее стандартным типом был myisam.</p>
<p>В версии MySQL 5.5 поддерживается 9 различных типов таблиц.</p>
<ul>
<li><strong>InnoDB</strong> - движок с поддержкой транзакций, откатов и защитой от
    потери данных. В данном типе таблиц используются блокировки на
    уровне записи и не блокирующее чтение, что позволило улучшить
    производительность при многопользовательском режиме работы. InnoDB
    сохраняет пользовательские данные в кластерных индексах, что
    позволяет компенсировать в/в для простых запросов основанных на
    первичных ключах.</li>
<li><strong>MyISAM</strong> - движок таблиц MySQL используемый в основном в
    Web-приложениях, хранилищах данных и других программных средах.
    Данный тип таблиц поддерживается всеми инсталляциями MySQL.</li>
<li><strong>Memory</strong> - хранит данные в оперативной памяти для очень быстрого
    доступа. Также известен как HEAP (куча).</li>
<li><strong>Merge</strong> - используется для логического объединения одинаковых
    MyISAM таблиц и обращение к ним, как к единому объекту. Хорошо
    подойдет для очень больших хранилищ данных.</li>
<li><strong>Archive</strong> - идеальное решение для хранения больших объёмов
    информации, к которой не требуется частый доступ.</li>
<li><strong>Federated</strong> - предоставляет возможность объединять различные MySQL
    сервера для создания одной логической базы данных из нескольких
    физических машин. Идеально подойдет для архитектур, которые
    поддерживают распределенное хранение данных.</li>
<li><strong>CSV</strong> - хранит пользовательские данные в текстовых файлах разделяя
    значения запятыми. Используется если необходим простой обмен с
    приложениями, которые умеют экспортировать/импортировать данные из
    CSV формата.</li>
<li><strong>Blackhole</strong> - принимает, но не возвращает никаких данных.
    Результатами любых запросов из таких хранилищ будут пустые выборки.</li>
<li><strong>Example</strong> - тестовый движок, не выполняет никаких функций, будет
    полезен только разработчикам, которые собираются писать свой движок,
    в качестве примера.</li>
</ul>
<p>Сравнительная таблица основных типов таблиц</p>
<table>
<thead>
<tr>
<th align="left">Функция</th>
<th align="left">MyISAM</th>
<th align="left">Memory</th>
<th align="left">InnoDB</th>
<th align="left">Archive</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Максимальный объём хранимых данных</td>
<td align="left">256TB</td>
<td align="left">RAM</td>
<td align="left">64TB</td>
<td align="left">Нет</td>
</tr>
<tr>
<td align="left">Транзакции</td>
<td align="left">Нет</td>
<td align="left">Нет</td>
<td align="left">Да</td>
<td align="left">Нет</td>
</tr>
<tr>
<td align="left">Блокировки</td>
<td align="left">Таблица</td>
<td align="left">Таблица</td>
<td align="left">Запись</td>
<td align="left">Запись</td>
</tr>
<tr>
<td align="left">MVCC</td>
<td align="left">Нет</td>
<td align="left">Нет</td>
<td align="left">Да</td>
<td align="left">Нет</td>
</tr>
<tr>
<td align="left">B-деревья</td>
<td align="left">Да</td>
<td align="left">Да</td>
<td align="left">Да</td>
<td align="left">Нет</td>
</tr>
<tr>
<td align="left">Хэш индексы</td>
<td align="left">Нет</td>
<td align="left">Да</td>
<td align="left">Нет</td>
<td align="left">Нет</td>
</tr>
<tr>
<td align="left">Индексы полнотекстового поиска</td>
<td align="left">Да</td>
<td align="left">Нет</td>
<td align="left">Нет</td>
<td align="left">Нет</td>
</tr>
<tr>
<td align="left">Кластерные индексы</td>
<td align="left">Нет</td>
<td align="left">Нет</td>
<td align="left">Да</td>
<td align="left">Нет</td>
</tr>
<tr>
<td align="left">Кэширование данных</td>
<td align="left">Нет</td>
<td align="left">Н/д</td>
<td align="left">Да</td>
<td align="left">Нет</td>
</tr>
<tr>
<td align="left">Кэширование индексов</td>
<td align="left">Да</td>
<td align="left">Н/д</td>
<td align="left">Да</td>
<td align="left">Нет</td>
</tr>
<tr>
<td align="left">Сжатие данных</td>
<td align="left">Да</td>
<td align="left">Нет</td>
<td align="left">Да</td>
<td align="left">Да</td>
</tr>
<tr>
<td align="left">Шифрование данных</td>
<td align="left">Да</td>
<td align="left">Да</td>
<td align="left">Да</td>
<td align="left">Да</td>
</tr>
<tr>
<td align="left">Поддержка кластерных БД</td>
<td align="left">Нет</td>
<td align="left">Нет</td>
<td align="left">Нет</td>
<td align="left">Нет</td>
</tr>
<tr>
<td align="left">Репликация</td>
<td align="left">Да</td>
<td align="left">Да</td>
<td align="left">Да</td>
<td align="left">Да</td>
</tr>
<tr>
<td align="left">Внешние ключи</td>
<td align="left">Нет</td>
<td align="left">Нет</td>
<td align="left">Да</td>
<td align="left">Нет</td>
</tr>
<tr>
<td align="left">Бэкап</td>
<td align="left">Да</td>
<td align="left">Да</td>
<td align="left">Да</td>
<td align="left">Да</td>
</tr>
<tr>
<td align="left">Кэширование запросов</td>
<td align="left">Да</td>
<td align="left">Да</td>
<td align="left">Да</td>
<td align="left">Да</td>
</tr>
</tbody>
</table>
<h2 id="innodb-myiasm">Тестирование производительность InnoDB и MyIASM</h2>
<p>Наибольший интерес для web-разработчика составляют innodb и myisam.
Сейчас мы проведем сравнительный тест производительности этих типов
таблиц. Для этого сначала создадим две одинаковые по структуре таблицы,
но с разным типом движка хранения:</p>
<pre><code>:::sql
CREATE TABLE `inno` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT,
  `data` VARCHAR(255) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB;

CREATE TABLE `myisam` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT,
  `data` VARCHAR(255) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM;
</code></pre>
<p>Напишем небольшой скрипт который будет выполнять 3 теста: запись данных
(insert), выборка по ключу, выборка по не ключевому полю.</p>
<pre><code>:::php
&lt;?php
// ...
class timer{
    public $value=0;

    public function start(){
        $this-&gt;value = microtime(true);
    }

    public function end(){
        return microtime(true) - $this-&gt;value;
    }
}

$timer = new timer();

mysql_connect('localhost','root');
mysql_select_db('test');

$data = array();
$select_query = 'SELECT data FROM myisam WHERE id = :val:';
for ($i = 0; $i &lt;= 10000; $i++){
    $result = mysql_query(str_replace(':val:', $i, $select_query));
    $tmp = mysql_fetch_array($result);
    $data[] = $tmp[0];
}

echo '&lt;br/&gt;MyISAM select&lt;br/&gt;';
$select_query = 'SELECT * FROM myisam WHERE data = :val:';
$timer-&gt;start();
foreach ($data as $one){
    mysql_query(str_replace(':val:', $one, $select_query));
}
echo $timer-&gt;end() . ' s&lt;br/&gt;';

echo '&lt;br/&gt;InnoDB select&lt;br/&gt;';
$select_query = 'SELECT * FROM inno WHERE data = :val:';
$timer-&gt;start();
foreach ($data as $one){
    mysql_query(str_replace(':val:', $one, $select_query));
}
echo $timer-&gt;end() . ' s&lt;br/&gt;';

/*

$data = array();
for ($i = 0; $i &lt;= 10000; $i++){
    $data[] = mt_rand(0, 100500);
}

echo '&lt;br/&gt;MyISAM select by key&lt;br/&gt;';
$select_query = 'SELECT * FROM myisam WHERE id = :val:';
$timer-&gt;start();
for ($i = 0; $i &lt;= 10000; $i++){
    mysql_query(str_replace(':val:', $i, $select_query));
}
echo $timer-&gt;end() . ' s&lt;br/&gt;';

echo '&lt;br/&gt;InnoDB select by key&lt;br/&gt;';
$select_query = 'SELECT * FROM inno WHERE id = :val:';
$timer-&gt;start();
for ($i = 0; $i &lt;= 10000; $i++){
    mysql_query(str_replace(':val:', $i, $select_query));
}
echo $timer-&gt;end() . ' s&lt;br/&gt;';
*/

/*

$data = array();
for ($i = 0; $i &lt;= 10000; $i++){
    $data[] = mt_rand(0, 100500);
}

echo '&lt;br/&gt;MyISAM insert&lt;br/&gt;';
$insert_query = 'INSERT INTO myisam VALUES (NULL,\':val:\')';
$timer-&gt;start();
foreach ($data as $one){
    mysql_query(str_replace(':val:', $one, $insert_query));
}
echo $timer-&gt;end() . ' s&lt;br/&gt;';

echo 'InnoDB insert&lt;br/&gt;';
$insert_query = 'INSERT INTO inno VALUES (NULL,\':val:\')';
$timer-&gt;start();
foreach ($data as $one){
    mysql_query(str_replace(':val:', $one, $insert_query));
}
echo $timer-&gt;end() . ' s&lt;br/&gt;';
 */
</code></pre>
<p>Для того что-бы выполнить тест, нужно раскоментить один соответствующий
блок кода. И собственно, то что у меня получилось в результате
тестирования:</p>
<table>
<thead>
<tr>
<th align="left">Тест</th>
<th align="left">InnoDB</th>
<th align="left">MyISAM</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Вставка данных(insert)</td>
<td align="left">15.697 с</td>
<td align="left">1.591 с</td>
</tr>
<tr>
<td align="left">Выборка по ключу</td>
<td align="left">1.678 с</td>
<td align="left">1.603 с</td>
</tr>
<tr>
<td align="left">Выборка по не ключевому полю</td>
<td align="left">149.961 c</td>
<td align="left">95.984 c</td>
</tr>
</tbody>
</table>
<p>Как мы видим myisam работает значительно быстрее, особенно это заметно
при вставке данных. Хотя innodb и дает ряд новых возможностей и
преимуществ, такая медлительность не позволяет ему конкурировать с
myisam, особенно в web-приложениях.</p>
    </div><!-- /.entry-content -->
    <div class="comments">
      <div id="disqus_thread"></div>
      <script type="text/javascript">
        var disqus_identifier = "bd/mysql-obzor-tipov-tablits/";
        (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://dizballanze.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
    </div>

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>ссылки</h2>
                        <ul>
                            <li><a href="http://wbtech.pro">WBTech</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>онлайн</h2>
                        <ul>
                            <li><a href="http://dizballanze.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>
                            <li><a href="http://dizballanze.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate">rss feed</a></li>

                            <li><a href="https://twitter.com/dizballanze">Twitter</a></li>
                            <li><a href="https://github.com/dizballanze">GitHub</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Powered by <a href="http://getpelican.com/">Pelican</a>, <a href="http://python.org">Python</a>.
                <section class="right">&copy; <a href="/avtor">Yuri Shikanov</a> 2010-2015</section>
                </address><!-- /#about -->

        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-20497524-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
<script type="text/javascript">
    var disqus_shortname = 'dizballanze';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>