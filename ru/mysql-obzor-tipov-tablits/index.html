<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="HandheldFriendly" content="true">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>MySQL - обзор типов таблиц</title>
    <link rel="stylesheet" href="/theme/css/native.css" />
    <link rel="stylesheet" type="text/css" href="/theme/css/main.css" />
    <link href="https://fonts.googleapis.com/css?family=PT+Serif&amp;subset=cyrillic" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=PT+Mono&amp;subset=cyrillic" rel="stylesheet">
    <!--[if IE]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-20497524-1', 'auto');
      ga('send', 'pageview');
    </script>
	
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
  "HTML-CSS": {
  styles: {
  ".MathJax .mo, .MathJax .mi": {color: "black ! important"}}
  },
  tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']],processEscapes: true}
  });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body id="index" class="home">
        <header id="banner" class="body">
            <h1><a href="/ru/">Tech blog by @dizballanze <strong></strong></a></h1>
            <div id="langs">
                <a href="/">En</a>
                <a href="/ru/">Ru</a>
            </div>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
            <li><a href="/ru/about-me/">Автор</a></li>
            <li><a href="https://wbtech.pro/">WB–Tech</a></li>
            <li><a href="https://debugmail.io/">DebugMail</a></li>
        </ul>
        </nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="/ru/mysql-obzor-tipov-tablits/" rel="bookmark"
         title="Permalink to MySQL - обзор типов таблиц">MySQL - обзор типов таблиц</a></h2>
    <time class="published" datetime="2011-01-29T18:42:00+03:00"><nobr>29 янв 2011</nobr></time>
  </header>
  <div class="entry-content">
    <p><img alt="mysql" src="/media/2011/01/mysql-125x125.png" title="MySQL logo"/></p>
<p>Здравствуйте, сегодня мы поговорим о типах таблиц в MySQL. Архитектура
MySQL позволяет подключать разные движки таблиц. На данный момент MySQL
поддерживает множество различных типов таблиц, каждый из которых имеет
свои преимущества и недостатки. Я перечислю и коротко опишу основные
типы таблиц, а затем проведу небольшой тест производительности наиболее
часто используемых типов - myisam и innodb.</p>
<p>Для того что-бы посмотреть какие типы поддерживает ваша инсталляция
MySQL необходимо выполнить следующий SQL запрос:</p>
<pre><code>:::sql
SHOW ENGINES;
</code></pre>
<p>В результате вы получаете таблицу содержащую информацию о том какие типы
таблиц установлены в вашей системе и краткое описание их возможностей.</p>
<p>Engine             | Support | Comment | Transactions | XA   | Savepoints
:------------------|:--------|:--------|:-------------|:-----|:-----------
FEDERATED          | NO      | Federated MySQL storage engine | NULL         | NULL | NULL CSV                | YES     | CSV storage engine                                             | NO           | NO   | NO       <br/>
MyISAM             | YES     | MyISAM storage engine                                          | NO           | NO   | NO       <br/>
BLACKHOLE          | YES     | /dev/null storage engine (anything you write to it disappears) | NO           | NO   | NO       <br/>
MRG_MYISAM         | YES     | Collection of identical MyISAM tables                          | NO           | NO   | NO       <br/>
MEMORY             | YES     | Hash based, stored in memory, useful for temporary tables      | NO           | NO   | NO       <br/>
ARCHIVE            | YES     | Archive storage engine                                         | NO           | NO   | NO       <br/>
InnoDB             | DEFAULT | Supports transactions, row-level locking, and foreign keys     | YES          | YES  | YES      <br/>
PERFORMANCE_SCHEMA | YES     | Performance Schema                                             | NO           | NO   | NO</p>
<p>Нас в основном будет интересовать столбец support, который содержит
информацию о поддержке типа таблицы и может принимать значения: NO - не
поддерживается, YES - поддерживается, DEFAULT -используется
по-умолчанию. Начиная с версии 5.5.5 по-умолчанию выбран тип innodb,
ранее стандартным типом был myisam.</p>
<p>В версии MySQL 5.5 поддерживается 9 различных типов таблиц.</p>
<ul>
<li><strong>InnoDB</strong> - движок с поддержкой транзакций, откатов и защитой от
    потери данных. В данном типе таблиц используются блокировки на
    уровне записи и не блокирующее чтение, что позволило улучшить
    производительность при многопользовательском режиме работы. InnoDB
    сохраняет пользовательские данные в кластерных индексах, что
    позволяет компенсировать в/в для простых запросов основанных на
    первичных ключах.</li>
<li><strong>MyISAM</strong> - движок таблиц MySQL используемый в основном в
    Web-приложениях, хранилищах данных и других программных средах.
    Данный тип таблиц поддерживается всеми инсталляциями MySQL.</li>
<li><strong>Memory</strong> - хранит данные в оперативной памяти для очень быстрого
    доступа. Также известен как HEAP (куча).</li>
<li><strong>Merge</strong> - используется для логического объединения одинаковых
    MyISAM таблиц и обращение к ним, как к единому объекту. Хорошо
    подойдет для очень больших хранилищ данных.</li>
<li><strong>Archive</strong> - идеальное решение для хранения больших объёмов
    информации, к которой не требуется частый доступ.</li>
<li><strong>Federated</strong> - предоставляет возможность объединять различные MySQL
    сервера для создания одной логической базы данных из нескольких
    физических машин. Идеально подойдет для архитектур, которые
    поддерживают распределенное хранение данных.</li>
<li><strong>CSV</strong> - хранит пользовательские данные в текстовых файлах разделяя
    значения запятыми. Используется если необходим простой обмен с
    приложениями, которые умеют экспортировать/импортировать данные из
    CSV формата.</li>
<li><strong>Blackhole</strong> - принимает, но не возвращает никаких данных.
    Результатами любых запросов из таких хранилищ будут пустые выборки.</li>
<li><strong>Example</strong> - тестовый движок, не выполняет никаких функций, будет
    полезен только разработчикам, которые собираются писать свой движок,
    в качестве примера.</li>
</ul>
<p>Сравнительная таблица основных типов таблиц</p>
<p>Функция | MyISAM | Memory | InnoDB | Archive
:-------|:-------|:-------|:-------|:-------
Максимальный объём хранимых данных | 256TB | RAM | 64TB | Нет
Транзакции | Нет | Нет | Да | Нет
Блокировки | Таблица | Таблица | Запись | Запись
MVCC | Нет | Нет | Да | Нет
B-деревья | Да | Да | Да | Нет
Хэш индексы | Нет | Да | Нет | Нет
Индексы полнотекстового поиска | Да | Нет | Нет | Нет
Кластерные индексы | Нет | Нет | Да | Нет
Кэширование данных | Нет | Н/д | Да | Нет
Кэширование индексов | Да | Н/д | Да | Нет
Сжатие данных | Да | Нет | Да | Да
Шифрование данных | Да | Да | Да | Да
Поддержка кластерных БД | Нет | Нет | Нет | Нет
Репликация | Да | Да | Да | Да
Внешние ключи | Нет | Нет | Да | Нет
Бэкап | Да | Да | Да | Да
Кэширование запросов | Да | Да | Да | Да</p>
<h2 id="testirovanie-proizvoditelnost-innodb-i-myiasm">Тестирование производительность InnoDB и MyIASM</h2>
<p>Наибольший интерес для web-разработчика составляют innodb и myisam.
Сейчас мы проведем сравнительный тест производительности этих типов
таблиц. Для этого сначала создадим две одинаковые по структуре таблицы,
но с разным типом движка хранения:</p>
<pre><code>:::sql
CREATE TABLE `inno` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT,
  `data` VARCHAR(255) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB;

CREATE TABLE `myisam` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT,
  `data` VARCHAR(255) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM;
</code></pre>
<p>Напишем небольшой скрипт который будет выполнять 3 теста: запись данных
(insert), выборка по ключу, выборка по не ключевому полю.</p>
<pre><code>:::php
&lt;?php
// ...
class timer{
    public $value=0;

    public function start(){
        $this-&gt;value = microtime(true);
    }

    public function end(){
        return microtime(true) - $this-&gt;value;
    }
}

$timer = new timer();

mysql_connect('localhost','root');
mysql_select_db('test');

$data = array();
$select_query = 'SELECT data FROM myisam WHERE id = :val:';
for ($i = 0; $i &lt;= 10000; $i++){
    $result = mysql_query(str_replace(':val:', $i, $select_query));
    $tmp = mysql_fetch_array($result);
    $data[] = $tmp[0];
}

echo '&lt;br/&gt;MyISAM select&lt;br/&gt;';
$select_query = 'SELECT * FROM myisam WHERE data = :val:';
$timer-&gt;start();
foreach ($data as $one){
    mysql_query(str_replace(':val:', $one, $select_query));
}
echo $timer-&gt;end() . ' s&lt;br/&gt;';

echo '&lt;br/&gt;InnoDB select&lt;br/&gt;';
$select_query = 'SELECT * FROM inno WHERE data = :val:';
$timer-&gt;start();
foreach ($data as $one){
    mysql_query(str_replace(':val:', $one, $select_query));
}
echo $timer-&gt;end() . ' s&lt;br/&gt;';

/*

$data = array();
for ($i = 0; $i &lt;= 10000; $i++){
    $data[] = mt_rand(0, 100500);
}

echo '&lt;br/&gt;MyISAM select by key&lt;br/&gt;';
$select_query = 'SELECT * FROM myisam WHERE id = :val:';
$timer-&gt;start();
for ($i = 0; $i &lt;= 10000; $i++){
    mysql_query(str_replace(':val:', $i, $select_query));
}
echo $timer-&gt;end() . ' s&lt;br/&gt;';

echo '&lt;br/&gt;InnoDB select by key&lt;br/&gt;';
$select_query = 'SELECT * FROM inno WHERE id = :val:';
$timer-&gt;start();
for ($i = 0; $i &lt;= 10000; $i++){
    mysql_query(str_replace(':val:', $i, $select_query));
}
echo $timer-&gt;end() . ' s&lt;br/&gt;';
*/

/*

$data = array();
for ($i = 0; $i &lt;= 10000; $i++){
    $data[] = mt_rand(0, 100500);
}

echo '&lt;br/&gt;MyISAM insert&lt;br/&gt;';
$insert_query = 'INSERT INTO myisam VALUES (NULL,\':val:\')';
$timer-&gt;start();
foreach ($data as $one){
    mysql_query(str_replace(':val:', $one, $insert_query));
}
echo $timer-&gt;end() . ' s&lt;br/&gt;';

echo 'InnoDB insert&lt;br/&gt;';
$insert_query = 'INSERT INTO inno VALUES (NULL,\':val:\')';
$timer-&gt;start();
foreach ($data as $one){
    mysql_query(str_replace(':val:', $one, $insert_query));
}
echo $timer-&gt;end() . ' s&lt;br/&gt;';
 */
</code></pre>
<p>Для того что-бы выполнить тест, нужно раскоментить один соответствующий
блок кода. И собственно, то что у меня получилось в результате
тестирования:</p>
<p>Тест                         | InnoDB    | MyISAM
:----------------------------|:----------|:--------
Вставка данных(insert)       | 15.697 с  | 1.591 с
Выборка по ключу             | 1.678 с   | 1.603 с
Выборка по не ключевому полю | 149.961 c | 95.984 c</p>
<p>Как мы видим myisam работает значительно быстрее, особенно это заметно
при вставке данных. Хотя innodb и дает ряд новых возможностей и
преимуществ, такая медлительность не позволяет ему конкурировать с
myisam, особенно в web-приложениях.</p>
  </div>
</section>
        <footer id="contentinfo" class="body">
            (c) 2010-2017
        </footer><!-- /#contentinfo -->
</body>
</html>