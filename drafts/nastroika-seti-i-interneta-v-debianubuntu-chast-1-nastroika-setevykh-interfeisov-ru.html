<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="HandheldFriendly" content="true">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Настройка сети и интернета в Debian/Ubuntu - часть 1 - Настройка сетевых интерфейсов</title>
    <link rel="stylesheet" href="/theme/css/native.css" />
    <link rel="stylesheet" type="text/css" href="/theme/css/main.css" />
    <link href="https://fonts.googleapis.com/css?family=PT+Serif&amp;subset=cyrillic" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=PT+Mono&amp;subset=cyrillic" rel="stylesheet">
    <!--[if IE]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-20497524-1', 'auto');
      ga('send', 'pageview');
    </script>
	
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
  "HTML-CSS": {
  styles: {
  ".MathJax .mo, .MathJax .mi": {color: "black ! important"}}
  },
  tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']],processEscapes: true}
  });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body id="index" class="home">
        <header id="banner" class="body">
            <h1><a href="/">Tech blog by @dizballanze <strong></strong></a></h1>
            <div id="langs">
                <a href="/">En</a>
                <a href="/ru/">Ru</a>
            </div>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
            <li><a href="/about-me/">Author</a></li>
            <li><a href="https://wbtech.pro/">WB–Tech</a></li>
            <li><a href="https://debugmail.io/">DebugMail</a></li>
        </ul>
        </nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="/drafts/nastroika-seti-i-interneta-v-debianubuntu-chast-1-nastroika-setevykh-interfeisov-ru.html" rel="bookmark"
         title="Permalink to Настройка сети и интернета в Debian/Ubuntu - часть 1 - Настройка сетевых интерфейсов">Настройка сети и интернета в Debian/Ubuntu - часть 1 - Настройка сетевых интерфейсов</a></h2>
    <time class="published" datetime="2011-02-22T13:17:00+03:00"><nobr>22 фев 2011</nobr></time>
  </header>
  <div class="entry-content">
    <p>Здравствуйте, товарищи линуксоиды ;[</p>
<p><img alt="network" src="/media/2011/02/network-300x225.jpg" title="network"/>В данном топике я хочу рассказать всё что может
потребоваться для настройки сети и подключения к интернету в linux. Я
буду рассматривать на примере своего любимого дистрибутива - Debian, но
я думаю это будет действительно и для других дистрибутивов, особенно для
Ubuntu, т.к. эти дистрибутивы близкие родственники. Итак, приступим...</p>
<h2 id="nastroika-setevykh-interfeisov">Настройка сетевых интерфейсов</h2>
<p>Первым делом мы рассмотрим конфигурирование самих сетевых интерфейсов.
Для этих целей в ОС Linux используется команда ifconfig.</p>
<h3 id="prosmotr-informatsii-o-setevykh-interfeisakh">Просмотр информации о сетевых интерфейсах</h3>
<p>Для того что-бы просмотреть информацию о сетевых интерфейсах выполните
команду ifconfig -a. В результате вы получите полный перечень всех
сетевых интерфейсов вашего компьютера в не зависимости от того активны
они или нет:</p>
<div class="highlight"><pre><span></span>ifconfig -a
eth0      Link encap:Ethernet  HWaddr <span class="m">00</span>:b3:65:78:12:a2  
          inet addr:10.32.1.40  Bcast:10.32.3.255  Mask:255.255.252.0
          inet6 addr: fe80::2b3:65ff:fe78:12a2/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:108514 errors:0 dropped:0 overruns:0 frame:0
          TX packets:52791 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:53877045 <span class="o">(</span><span class="m">51</span>.3 MiB<span class="o">)</span>  TX bytes:7714438 <span class="o">(</span><span class="m">7</span>.3 MiB<span class="o">)</span>
          Interrupt:17

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:1567 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1567 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:49660 <span class="o">(</span><span class="m">48</span>.4 KiB<span class="o">)</span>  TX bytes:49660 <span class="o">(</span><span class="m">48</span>.4 KiB<span class="o">)</span>
</pre></div>
<p>Как вы видите данная команда выводит такую информацию, как ip-адрес
(inet addr), mac-адрес (HWaddr), маска подсети (Mask), статистика по
переданным/принятым пакетам (RX packets - полученные пакеты, TX packets
- переданные пакеты). В моём случае команда вывела информацию о двух
сетевых интерфейсах: eth0 и lo. Рассмотрим каждый из них в отдельности.
Первый - это сетевая карта ethernet имеет ip-адрес 10.32.1.40, маску
подсети - 255.255.252.0 и mac-адрес - 00:b3:65:78:12:a2. Второй - lo или
local loopback (локальная петля) используется для того, что-бы компьютер
мог обращаться к самому себе и имеет по-умолчанию ip-адрес 127.0.0.1 на
всех компьютерах. Оба интерфейса запущены, это можно определить по
четвёртой строке, как вы видите она начинается со слова "UP".</p>
<p>Команда ifconfig с параметром -a выводит информацию о всех сетевых
интерфейсах, если же этот параметр опустить, то будет выведена
информация только о активных (запущенных) сетевых интерфейсах.</p>
<h3 id="aktivatsiiadezaktivatsiia-interfeisa">Активация/дезактивация интерфейса</h3>
<p>Для того что-бы активировать/дезактивировать сетевой интерфейс
необходимо воспользоваться уже знакомой нам командой ifconfig передав
первым параметром название, а вторым одно из ключевых слов up или down.
Также вы можете воспользоваться командами ifup и ifdown которым нужно
передать название интерфейса. Пример:</p>
<div class="highlight"><pre><span></span>ifconfig
lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:1567 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1567 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:49660 <span class="o">(</span><span class="m">48</span>.4 KiB<span class="o">)</span>  TX bytes:49660 <span class="o">(</span><span class="m">48</span>.4 KiB<span class="o">)</span>
ifconfig eth0 up
ifconfig
eth0      Link encap:Ethernet  HWaddr <span class="m">00</span>:b3:65:78:12:a2  
          inet addr:10.32.1.40  Bcast:10.32.3.255  Mask:255.255.252.0
          inet6 addr: fe80::2b3:65ff:fe78:12a2/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:108514 errors:0 dropped:0 overruns:0 frame:0
          TX packets:52791 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:53877045 <span class="o">(</span><span class="m">51</span>.3 MiB<span class="o">)</span>  TX bytes:7714438 <span class="o">(</span><span class="m">7</span>.3 MiB<span class="o">)</span>
          Interrupt:17

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:1567 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1567 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:49660 <span class="o">(</span><span class="m">48</span>.4 KiB<span class="o">)</span>  TX bytes:49660 <span class="o">(</span><span class="m">48</span>.4 KiB<span class="o">)</span>
</pre></div>
<h3 id="nastroika-parametrov-setevogo-interfeisa">Настройка параметров сетевого интерфейса</h3>
<p>Перейдем непосредственно к настройке параметров интерфейсов. Разберем на
примере. Сначала настроим ip-адрес интерфейса eth0</p>
<div class="highlight"><pre><span></span>ifconfig eth0 <span class="m">10</span>.32.1.40
</pre></div>
<p>Просто указываем название интерфейса и адрес в стандартном формате.
Далее настроим маску подсети:</p>
<div class="highlight"><pre><span></span>ifconfig eth0 netmask <span class="m">255</span>.255.252.0
</pre></div>
<p>Здесь тоже всё просто, указали название интерфейса, ключевое слово
netmask и собственно саму маску подсети. Иногда может понадобится
сменить mac-адрес интерфейса, особенно с этим часто встречаются при
смене оборудования к адресу которого привязана авторизация у
интернет-провайдера. В этом нам тоже может помочь утилита ifconfig:</p>
<div class="highlight"><pre><span></span>ifconfig eth0 hw ether 00b3657812a2
</pre></div>
<h3 id="sokhranenie-parametrov-posle-perezagruzki">Сохранение параметров после перезагрузки</h3>
<p>С настройкой интерфейсов вроде разобрались. Но при перезагрузке системы
вы увидите, что параметры не сохраняются. Для того что-бы интерфейс
автоматически конфигурировался при каждом старте системы нам нужно
прописать все параметры в файле /etc/network/interfaces. Ниже я приведу
пример своего файла interfaces и мы сможем на нём разобраться в
структуре описания параметров интерфейсов.</p>
<div class="highlight"><pre><span></span>auto lo
iface lo inet loopback

allow-hotplug eth0
iface eth0 inet static
    address 10.32.1.40
    netmask 255.255.252.0
    network 10.32.0.0
    broadcast 10.32.3.255
    gateway 10.32.0.1
    dns-nameservers 10.32.0.1
    dns-search dizballanze
</pre></div>
<p>На данном этапе нас не интересуют параметры маршрутизации и серверов
имён, об этом мы поговорим в следующем топике, поэтому последние 3
строки мы не рассматриваем. Итак, у нас есть секции iface каждая из
которых описывает один сетевой интерфейс. Также у нас секции allow-*
которые описывают правила по которым должны активироваться интерфейсы.
Теперь рассмотрим подробнее вторую секцию iface файла. Первая строка
секции содержит директиву address, которая задаёт ip-адрес интерфейса.
Директива netmask задаёт маску подсети, network - адрес подсети,
broadcast - широковещательный адрес. Основные параметры мы настроили,
осталось только установить mac-адрес. Здесь всё немного сложнее, нам
необходимо написать простой bash-скрипт, который будет запускаться перед
активацией интерфейса. Для этого создадим от пользователя root файл в
директории /etc/network/if-pre-up.d и назовем его например init. В файле
будет содержаться уже знакомая нам команда:</p>
<div class="highlight"><pre><span></span><span class="ch">#! /bin/sh</span>
ifconfig eth0 hw ether 00b3657812a2
</pre></div>
<p>Теперь перед активацией интерфейсов будет запущена программа ifconfig,
которая выставит нужный нам аппаратный адрес. На этом первая часть
статьи окончена. В следующих частях я планирую рассказать про настройку
маршрутизации и dns. Спасибо за внимание, вопросы в комментах!</p>
<p>Настройка сети и интернета в Debian/Ubuntu &ndash; часть 2 &ndash; DHCP, DNS,
маршрутизация</p>
  </div>
</section>
        <footer id="contentinfo" class="body">
            (c) 2010-2018
        </footer><!-- /#contentinfo -->
</body>
</html>